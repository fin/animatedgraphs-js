<html>
    <head>
        <title>Animated Transitions with Javascript</title>
        <script src="3rdparty/raphael.js"></script>
        <script src="shapes.js"></script>
        <script src="3rdparty/g.raphael/g.raphael.js"></script>
        <script src="g.bar.path.js"></script>
        <script src="g.pie.path.js"></script>
        <script src="animate.js"></script>
        <style type="text/css">
	         #outercontainer {position:absolute; width:100%; height:100%}
	         #testcanvas {background-image:url(background.png); position:absolute;
                        width:650px; height:420px ;top:50%; left:50%;
                        margin-top:-210px ; margin-left:-325px}
           #title {position:relative; left:50%; width:650px; margin-left:-325px; height:20px; margin-top:-10px}
        </style>
    </head>
    
    <body bgcolor="#eeeeee">
        <div id="outercontainer">        
          <div id="testcanvas">            
          </div>
          <div id="title">
              <p><h2>Animated Transitions Javascript Demo</h2></p>
            </div>          
        </div>
    </body>
    <p>
        <script type="text/javascript">
            raphael = new Raphael("testcanvas", 650, 420);

            //circle_path = raphael.circlepath(100, 100, 10);
            //circle = raphael.path(circle_path);
            //circle.attr({'fill': 'red'}).attr({'stroke': 'transparent'});

            //x = raphael.g.barchart(10, 10, 300, 220, [[55, 20, 13, 32, 5, 1, 2, 10]])
            x = raphael.g.barchart(10, 10, 300, 220, [[55, 20, 13, 32, 5, 1, 2, 10], [100, 50]], {stacked: true});

            for(var i=0;i<x.bars.length;i++) {
                for(var j=0;j<x.bars[i].length;j++) {
                    var bar = x.bars[i][j];
                    path = raphael.path((bar.attributes && bar.attributes.path) || bar.obj);
                }
            }
            
            y = raphael.g.piechart(320, 240, 100, [55, 20, 13, 32, 5, 1, 2]);
            
            paths = [];

            //TODO: change data structure and adapt g.pie.path code
            //enhance pie chart to ring chart capabilities
            function renderPaths(series) {
                for(var i=0;i<series.length;i++) {
                    if(paths.length<=i) {
                        paths.push([])
                    }
                    for(var j=0;j<series[i].length;j++) {
                        var pie = series[i][j];    //TODO: still a one-dimensional array!!
                        if(paths[i].length<=j) {
                            path = raphael.path((pie.attributes && pie.attributes.path) || pie.obj);
                            paths[i].push(path);
                        } else {
                            path = paths[i][j];
                            path.animate({'path': (pie.attributes && pie.attributes.path) || pie.obj}, 1024);
                        }
                    }
                }
            }

            renderPaths(y.series);
            
            y = raphael.g.piechart(320, 240, 100, [85, 10, 3, 12, 5, 1, 2]);
            renderPaths(y.series);
            //z = raphael.g.piechart(320, 240, 150, [55, 20, 13, 32, 5, 1, 2, 10]);

  //  y = raphael.g.piechart(320, 240, 100, [55, 20, 13, 32, 5, 1, 2]);
  //              y = raphael.g.piechart(320, 240, 100, [55, 20, 13, 32, 5, 1, 2]);

//            rectangle_path = raphael.rectpath(100, 100, 100, 50);
//            rectangle = raphael.path(rectangle_path).attr({'stroke': 'transparent'});
//
//            x = function() { circle.animate({'path': raphael.rectpath(100, 100, 100, 50)}, 1000, ">"); 
//                setTimeout(function() { circle.animate({'path': raphael.circlepath(100, 100, 10)}, 1000, ">"); setTimeout(x, 2000); }, 2000);
//            };

//            setTimeout(x, 1000);
        </script>
        </p>
</html>
